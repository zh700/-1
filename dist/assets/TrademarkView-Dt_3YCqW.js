import{I as v,d as Q,u as W,a as m,r as X,A as Y,e as s,L as Z,o as _,c as T,b as a,w as o,y as F,p as V,k,h as z,x as N,J as p,_ as ee}from"./index-kmnJ3fi5.js";const ae=(i,d)=>v.get(`/admin/product/baseTrademark/${i}/${d}`),te=i=>i.id?v.put("/admin/product/baseTrademark/update",i):v.post("/admin/product/baseTrademark/save",i),le=i=>v.delete("/admin/product/baseTrademark/remove/"+i),oe=["src"],re=["src"],se={class:"dialog-footer"},ne=Q({__name:"TrademarkView",setup(i){W();const d=m(1),y=m(3),U=m(0),b=m([]),u=m(!1),l=X({tmName:"",logoUrl:"",code:0}),c=m(),f=async(t=1)=>{d.value=t;const e=await ae(d.value,y.value);e.code==200&&(U.value=e.data.total,b.value=e.data.records)};Y(()=>{f()});const C=()=>{f()},w=()=>{u.value=!0,l.id=0,l.tmName="",l.logoUrl="",N(()=>{c.value.clearValidate("tmName"),c.value.clearValidate("logoUrl")})},h=t=>{N(()=>{c.value.clearValidate("tmName"),c.value.clearValidate("logoUrl")}),u.value=!0,Object.assign(l,t)},O=()=>{u.value=!1},q=async()=>{await c.value.validate(),(await te(l)).code==200?(u.value=!1,p.success({type:"success",message:l.id?"修改品牌成功":"添加品牌成功"}),f(l.id?d.value:1)):(p.error({type:"error",message:l.id?"修改品牌失败":"添加品牌失败"}),u.value=!1)},D=t=>t.type=="image/jpeg"||t.type=="image/png"||t.type=="image/gif"?t.size/1024/1024<4?!0:(p.error({type:"error",message:"上传图片大小不得超过4MB!"}),!1):(p.error({type:"error",message:"请上传图片格式为 jpeg, png, gif!"}),!1),E=t=>{l.logoUrl=t.data,c.value.clearValidate("logoUrl")},L={tmName:[{required:!0,trigger:"blur",validator:(t,e,n)=>{e.trim().length>=2?n():n(new Error("品牌名称位数大于等于两位"))}}],logoUrl:[{required:!0,validator:(t,e,n)=>{e?n():n(new Error("LOGO图片务必上传"))}}]},P=async t=>{(await le(t)).code==200?(p({type:"success",message:"删除品牌成功"}),f(b.value.length>1?d.value:d.value-1)):p({type:"error",message:"删除品牌失败"})};return(t,e)=>{const n=s("el-button"),g=s("el-table-column"),S=s("el-popconfirm"),A=s("el-table"),$=s("el-pagination"),j=s("el-card"),M=s("el-input"),x=s("el-form-item"),B=s("Plus"),G=s("el-icon"),H=s("el-upload"),I=s("el-form"),R=s("el-dialog"),J=Z("has");return _(),T("div",null,[a(j,{class:"box-card"},{default:o(()=>[F((_(),V(n,{type:"primary",size:"default",icon:"Plus",class:"button",onClick:w},{default:o(()=>e[4]||(e[4]=[k("添加品牌")])),_:1})),[[J,"btn.Trademark.add"]]),a(A,{style:{margin:"10px 0px"},border:"",data:b.value},{default:o(()=>[a(g,{label:"序号",width:"80px",align:"center",type:"index"}),a(g,{label:"品牌名称",prop:"tmName"}),a(g,{label:"品牌LOGO"},{default:o(({row:r})=>[z("img",{src:r.logoUrl,style:{width:"100px",height:"100px"}},null,8,oe)]),_:1}),a(g,{label:"品牌操作"},{default:o(({row:r})=>[a(n,{type:"primary",size:"small",icon:"Edit",onClick:K=>h(r),class:"Edit"},null,8,["onClick"]),a(S,{title:`您确定要删除${r.tmName}`,width:"250px",icon:"Delete",onConfirm:K=>P(r.id)},{reference:o(()=>[a(n,{type:"primary",size:"small",icon:"Delete",class:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),a($,{"current-page":d.value,"onUpdate:currentPage":e[0]||(e[0]=r=>d.value=r),"page-size":y.value,"onUpdate:pageSize":e[1]||(e[1]=r=>y.value=r),"pager-count":9,"page-sizes":[3,5,7,9],size:"default",background:!0,layout:"total, sizes, prev, pager, -> ,next, jumper",total:U.value,onSizeChange:C,onCurrentChange:f},null,8,["current-page","page-size","total"])]),_:1}),a(R,{modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=r=>u.value=r),title:l.id?"修改品牌":"添加品牌"},{footer:o(()=>[z("div",se,[a(n,{type:"primary",size:"default",onClick:O},{default:o(()=>e[5]||(e[5]=[k("取消")])),_:1}),a(n,{type:"primary",size:"default",onClick:q},{default:o(()=>e[6]||(e[6]=[k("确定")])),_:1})])]),default:o(()=>[a(I,{style:{width:"80%"},model:l,rules:L,ref_key:"formRef",ref:c},{default:o(()=>[a(x,{label:"品牌名称","label-width":"100px",prop:"tmName"},{default:o(()=>[a(M,{placeholder:"请你输入品牌名称",modelValue:l.tmName,"onUpdate:modelValue":e[2]||(e[2]=r=>l.tmName=r)},null,8,["modelValue"])]),_:1}),a(x,{label:"品牌LOGO","label-width":"100px",prop:"logoUrl"},{default:o(()=>[a(H,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":E,"before-upload":D},{default:o(()=>[l.logoUrl?(_(),T("img",{key:0,src:l.logoUrl,class:"avatar"},null,8,re)):(_(),V(G,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[a(B)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ce=ee(ne,[["__scopeId","data-v-72da4888"]]);export{ce as default};
